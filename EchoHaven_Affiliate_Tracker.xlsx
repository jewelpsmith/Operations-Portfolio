import pandas as pd
from io import BytesIO

# --- Content Calendar Sample ---
content_calendar = pd.DataFrame({
    "Platform": ["Pinterest", "Instagram", "Facebook", "LinkedIn", "Website"] * 2,
    "Post Date": [
        "2025-10-21", "2025-10-22", "2025-10-23", "2025-10-24", "2025-10-25",
        "2025-10-28", "2025-10-29", "2025-10-30", "2025-10-31", "2025-11-01"
    ],
    "Post Title": [
        "Top 10 Amazon Tech Gadgets", "Best Home Finds on Amazon",
        "Affordable Beauty Picks", "Office Must-Haves", "Shop Everything Day Sale",
        "Holiday Gift Guide", "Amazon Kitchen Essentials", "Smart Lifestyle Tools",
        "Home Office Setup Ideas", "Fall Favorites on Amazon"
    ],
    "Content Type": [
        "Pin", "Reel", "Post", "Article", "Blog",
        "Pin", "Carousel", "Post", "Article", "Blog"
    ],
    "Amazon Link": [
        "https://amzn.to/example1", "https://amzn.to/example2", "https://amzn.to/example3",
        "https://amzn.to/example4", "https://amzn.to/example5",
        "https://amzn.to/example6", "https://amzn.to/example7", "https://amzn.to/example8",
        "https://amzn.to/example9", "https://amzn.to/example10"
    ],
    "Status": ["Planned", "Planned", "In Design", "Scheduled", "Posted",
               "Idea", "Planned", "Ready", "Scheduled", "Posted"],
    "Category": ["Tech", "Home", "Beauty", "Office", "General",
                 "Seasonal", "Kitchen", "Lifestyle", "Office", "Seasonal"],
    "Engagement Goal (%)": [5, 6, 4, 5, 7, 6, 5, 5, 4, 6]
})

# --- Affiliate Tracker Sample ---
affiliate_tracker = pd.DataFrame({
    "Product": [
        "Echo Dot", "Air Fryer", "LED Vanity Mirror", "Desk Organizer",
        "Wireless Mouse", "Smart Plug", "Mini Projector", "Water Bottle",
        "Bluetooth Speaker", "Coffee Maker"
    ],
    "ASIN": [
        "B09NQ", "B08XYZ", "B07MIR", "B09ORG", "B08MSE",
        "B07PLG", "B09PRJ", "B08WTR", "B09SPK", "B09COF"
    ],
    "Short Link": [
        "https://amzn.to/example1", "https://amzn.to/example2", "https://amzn.to/example3",
        "https://amzn.to/example4", "https://amzn.to/example5",
        "https://amzn.to/example6", "https://amzn.to/example7",
        "https://amzn.to/example8", "https://amzn.to/example9", "https://amzn.to/example10"
    ],
    "Category": ["Tech", "Kitchen", "Beauty", "Office", "Tech", "Home", "Tech", "Lifestyle", "Tech", "Kitchen"],
    "Clicks": [250, 400, 150, 180, 230, 270, 320, 190, 210, 340],
    "CTR (%)": [5.1, 4.8, 3.5, 4.2, 5.0, 4.6, 5.2, 3.9, 4.7, 5.1],
    "Conversions": [12, 20, 8, 9, 10, 11, 15, 6, 8, 13],
    "Revenue ($)": [45, 80, 28, 32, 35, 40, 55, 25, 30, 50]
})

# --- KPI Dashboard (summary) ---
kpi_data = {
    "Metric": ["Total Clicks", "Average CTR (%)", "Total Conversions", "Total Revenue ($)", "Avg Engagement Goal (%)"],
    "Value": [
        affiliate_tracker["Clicks"].sum(),
        round(affiliate_tracker["CTR (%)"].mean(), 2),
        affiliate_tracker["Conversions"].sum(),
        affiliate_tracker["Revenue ($)"].sum(),
        round(content_calendar["Engagement Goal (%)"].mean(), 2)
    ]
}
kpi_dashboard = pd.DataFrame(kpi_data)

# --- Compliance Log ---
compliance_log = pd.DataFrame({
    "Post URL": [f"https://echohavenjournal.com/post-{i}" for i in range(1, 6)],
    "Disclosure Used": [
        "As an Amazon Associate, I earn from qualifying purchases." for _ in range(5)
    ],
    "Compliant (Y/N)": ["Y", "Y", "Y", "Y", "Y"]
})

# --- Create Excel file ---
excel_buffer = BytesIO()
with pd.ExcelWriter(excel_buffer, engine="openpyxl") as writer:
    content_calendar.to_excel(writer, index=False, sheet_name="Content Calendar")
    affiliate_tracker.to_excel(writer, index=False, sheet_name="Affiliate Tracker")
    kpi_dashboard.to_excel(writer, index=False, sheet_name="KPI Dashboard")
    compliance_log.to_excel(writer, index=False, sheet_name="Compliance Log")

# Save Excel file locally
excel_path = "EchoHaven_Affiliate_Tracker.xlsx"
with open(excel_path, "wb") as f:
    f.write(excel_buffer.getvalue())

print(f"âœ… Excel file created successfully: {excel_path}")
